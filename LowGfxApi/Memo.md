# 3D  グラフィックス低レベルAPI に関するメモ

## Vulkan 

★マークがあるところは他の箇所と値を一致させる必要あり。

### コマンドバッファで設定する単位

- RenderPassBegin（レンダーターゲットクリアのトリガーも担う）
  - レンダーパス（★2）
    - レンダーターゲットのフォーマット（★1）
    - loadOp storeOp
  - レンダーターゲット（★1）
  - レンダーエリア
    - https://qiita.com/Pctg-x8/items/2b3d5c8a861f42aa533f
  - レンダーターゲットクリアカラー
- パイプライン
  - レンダーパス（★2）
  - シェーダー
  - 頂点バッファレイアウト
  - プリミティブトポロジ
  - ビューポート
  - シザー矩形
  - ラスタライズステート
    - FillMode
    - CullMode
    - FrontFace
    - DepthBias系
  - マルチサンプリングオプション
  - デプスステンシルステート
  - ブレントステート
  - パイプラインレイアウト（シェーダーバインド宣言）（★3）
    - ディスクリプタセットレイアウト配列（★4）
      - コンスタントバッファビュー（ユニフォームバッファ）の宣言
      - ストレージバッファビューの宣言
      - サンプラーの宣言
    - インラインコンスタントデータの宣言（PushConstant）（★5）
- ディスプリプタセット配列（シェーダーバインド実体）（★4）
  - コンスタントバッファビュー（ユニフォームバッファ）
  - テクスチャビュー（イメージビュー）
  - ストレージバッファビュー
  - サンプラー
  - パイプラインレイアウト（★3）
- その他の直接設定
  - ビューポート（VK_DYNAMIC_STATE_VIEWPORT が有効なパイプラインの場合）
  - シザー矩形（VK_DYNAMIC_STATE_SCISSOR が有効なパイプラインの場合）
  - プリミティブトポロジ（VK_DYNAMIC_STATE_PRIMITIVE_TOPOLOGY_EXT が有効なパイプラインの場合）
  - 頂点バッファ・インデックスバッファ
  - インラインコンスタントデータ（PushConstants）（★5）
  - 他にも DYNAMIC_STATE で指定されたものが設定可能
- トリガー
  - 描画系
  - コンピュート

## DirectX 12

### コマンドリストで設定する単位

★マークがあるところは他の箇所と値を一致させる必要あり。

- パイプラインステート
  - ルートシグネチャのポインタ（★1）
  - ラスタライズステート
    - FillMode
    - CullMode
    - FrontFace
    - DepthBias系
  - マルチサンプリングオプション
  - デプスステンシルステート
  - ブレンドステート
  - 頂点バッファレイアウト
  - 頂点シェーダー
  - ピクセルシェーダー
  - プリミティブトポロジタイプ（点, 線, 三角形）（★3）
  - レンダーターゲットのフォーマット（★2）
- ルートシグネチャ（=シェーダーバインド宣言＆実体）（★1）
  - コンスタントバッファビュー 
  - テクスチャビュー（シェーダーリソースビュー）
  - サンプラー
  - ストレージバッファビュー（UAV:unordered access view）
- その他の直接設定
  - レンダーターゲット設定（★2）
  - ビューポート
  - シザー矩形
  - ブレンド係数
  - ステンシルテスト参照値
  - プリミティブトポロジ（★3）
  - 頂点バッファ・インデックスバッファ
- トリガー
  - レンダーターゲットのクリア
  - 描画系

### パイプラインステートのシリアライズ

https://shobomaru.wordpress.com/2015/07/22/d3d12-pipeline-state/

ルートシグネチャへのポインタがありますけどシリアライズとは・・・？

## Metal

### コマンドエンコーダで設定する単位

- レンダーパス（これを引数にコマンドエンコーダを作成・レンダーターゲットクリアのトリガーも担う）
  - レンダーターゲット
  - loadOp storeOp
  - レンダーターゲットクリアカラー
- パイプラインステート（RenderPipeline/ComputePipeline）
  - シェーダー
  - 頂点バッファレイアウト
  - レンダーターゲットのフォーマット
  - マルチサンプリングオプション
  - コンスタントバッファビューの書き込み可能属性指定（なにこれ？）
- アーギュメントバッファ（全部指定する必要なし・シェーダーバインド宣言＆実体として扱い可能）
  - コンスタントバッファビュー（MTLBuffer : MTLResource）
  - テクスチャビュー（MTLTexture : MTLResource）
  - サンプラー（MTLSamplerState）
  - インラインコンスタントデータ
- その他の直接設定
  - ラスタライズステート
    - FillMode
    - CullMode
    - FrontFace
    - DepthBias系
  - デプスステンシルステート
  - ブレントステート
  - アーギュメントバッファで指定できる各パラメータ
  - ビューポート
  - シザー矩形
  - 頂点バッファ・インデックスバッファ
- トリガー
  - 描画系（プリミティブトポロジは引数で指定）
  - コンピュート


## 要調査

- Vulkan
  - ブレンド係数
  - ステンシルテスト参照値
- Metal
  - ブレンド係数
  - ステンシルテスト参照値
- 共通
  - インダイレクト引数描画の方法

## 参考

- [A Comparison of Modern Graphics APIs](https://alain.xyz/blog/comparison-of-modern-graphics-apis)

